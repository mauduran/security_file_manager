(this.webpackJsonpfirma_docs_web=this.webpackJsonpfirma_docs_web||[]).push([[0],{30:function(e,t,a){e.exports=a(66)},35:function(e,t,a){},36:function(e,t,a){},59:function(e,t,a){},60:function(e,t,a){},62:function(e,t,a){},63:function(e,t,a){},64:function(e,t,a){},65:function(e,t,a){},66:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(27),l=a.n(c),o=(a(35),a(1)),s=a(10),u=(a(36),function(e){var t=e.setisLogged,a=e.isLogged,n=e.currentUser;return r.a.createElement("nav",{id:"navbar"},r.a.createElement("h1",{id:"nav-title"},"TLS Website"),a?r.a.createElement("ul",null,r.a.createElement(s.b,{exact:!0,to:"/",activeClassName:"selected"},r.a.createElement("li",null,r.a.createElement("p",null,"Home"))),r.a.createElement(s.b,{exact:!0,to:"/information",activeClassName:"selected"},r.a.createElement("li",null,r.a.createElement("p",null,"Information"))),r.a.createElement(s.b,{exact:!0,to:"/activity",activeClassName:"selected"},r.a.createElement("li",null,r.a.createElement("p",null,"Activity"))),r.a.createElement(s.b,{to:"/upload",activeClassName:"selected"},r.a.createElement("li",null,r.a.createElement("p",null,"Upload")))):r.a.createElement("ul",null,r.a.createElement(s.b,{to:"/login",activeClassName:"selected"},r.a.createElement("li",null,r.a.createElement("p",null,"Login"))),r.a.createElement(s.b,{to:"/register",activeClassName:"selected"},r.a.createElement("li",null,r.a.createElement("p",null,"Register")))),a&&r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"Logged in as ",n),r.a.createElement("p",{onClick:function(){t(!1),localStorage.removeItem("user")},style:{cursor:"pointer"}},"Logout")))}),m=a(9),i=a.n(m),f=a(29),p=a.n(f),d=(a(59),function(e){var t=e.file,a=e.setmessage,n=e.currentUser,c=e.getFiles,l=function(){fetch("/download/".concat(t.filename),{headers:{Authorization:n}}).then((function(e){return e.blob()})).then((function(e){p()(e,t.filename)})).catch((function(e){return alert(e)}))};return r.a.createElement(r.a.Fragment,null,"encrypted"===t.status?r.a.createElement("div",{className:"file-box"},r.a.createElement("i",{className:"fas fa-lock",onClick:l}),r.a.createElement("p",null,t.filename),r.a.createElement("button",{type:"button",className:"btn btn-primary pl-4 pr-4 mt-2",onClick:function(){fetch("/decrypt/".concat(t.filename),{headers:{Authorization:n}}).then((function(e){return e.json()})).then((function(e){a(e),c(n)})).catch((function(e){return a(e)}))}},"Decrypt")):r.a.createElement("div",{className:"file-box"},r.a.createElement("i",{className:"fas fa-file-alt",onClick:l}),r.a.createElement("p",null,t.filename),r.a.createElement("a",{href:"/signatures/".concat(t.filename,"?username=").concat(n)},"Check signature."),r.a.createElement("button",{type:"button",className:"btn btn-primary pl-4 pr-4 mt-2",onClick:function(){fetch("/verify/".concat(t.filename)).then((function(e){return e.json()})).then((function(e){a(e?"".concat(t.filename," verified successfully!"):"".concat(t.fileName," is not verified!"))})).catch((function(e){return a("Could not verify ".concat(t.filename))}))}},"Verify"),r.a.createElement("button",{type:"button",className:"btn btn-secondary pl-4 pr-4 mt-2",onClick:function(){fetch("/encrypt/".concat(t.filename),{headers:{Authorization:n}}).then((function(e){return e.json()})).then((function(e){a(e),c(n)})).catch((function(e){return a(e)}))}},"Encrypt")))}),b=function(e){var t=e.message,a=e.onClick;return r.a.createElement("div",{className:"alert alert-info alert-dismissible fade show",role:"alert"},t,r.a.createElement("button",{type:"button",className:"close","data-dismiss":"alert",onClick:a,"aria-label":"Close"},r.a.createElement("span",{"aria-hidden":"true"},"\xd7")))};a(60);function E(e){var t=e.currentUser,a=Object(n.useState)([]),c=Object(o.a)(a,2),l=c[0],s=c[1],u=Object(n.useState)(""),m=Object(o.a)(u,2),f=m[0],p=m[1];Object(n.useEffect)((function(){E(t)}),[t]);var E=function(e){i.a.get("/files",{headers:{Authorization:e}}).then((function(e){s(e.data)}))};return r.a.createElement("div",{className:"mt-4",style:{width:"90%",margin:"0 auto"}},f&&r.a.createElement(b,{message:f}),r.a.createElement("h1",{className:"m-4"},"Existing Files"),l?r.a.createElement("div",{className:"file-container"},l.map((function(e){return r.a.createElement(d,{key:e.filename,getFiles:E,currentUser:t,file:e,setmessage:p})}))):r.a.createElement("h2",null,"Empty directory"))}var h=a(7),g=a.n(h),v=a(11);a(62);function N(e){var t=e.setisLogged,a=e.setcurrentUser,c=Object(n.useState)(""),l=Object(o.a)(c,2),s=l[0],u=l[1],m=Object(n.useState)(""),f=Object(o.a)(m,2),p=f[0],d=f[1],E=Object(n.useState)(""),h=Object(o.a)(E,2),N=h[0],y=h[1],j=Object(n.useState)(!1),O=Object(o.a)(j,2),w=O[0],C=O[1],S=Object(n.useState)(""),x=Object(o.a)(S,2),k=x[0],U=x[1],q=function(){var e=Object(v.a)(g.a.mark((function e(t){var a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),s&&p||y("Missing Fields"),e.prev=2,e.next=5,i.a.post("/login",{username:s,password:p});case 5:a=e.sent,C(!0),u(a.data.username),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),y(e.t0.response.data);case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=Object(v.a)(g.a.mark((function e(){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,i.a.post("/login/verify",{username:s,token:k});case 5:n=e.sent,localStorage.setItem("user",s),y(n.data.message),a(s),C(!1),t(!0),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),y(e.t0.response.data);case 16:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"container mt-5"},N&&r.a.createElement(b,{message:N,onClick:function(){return y("")}}),w?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"form-group "},r.a.createElement("input",{type:"text",className:"form-control",value:k,onChange:function(e){return U(e.target.value)},placeholder:"Two Factor Auth code"})),r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{className:"btn btn-primary",onClick:F},"Verify Code"))):r.a.createElement("div",{className:"login-container"},r.a.createElement("form",{onSubmit:q,className:"login-form",method:"post"},r.a.createElement("h2",{className:"text-center mb-4"},"Log In"),r.a.createElement("div",{className:"form-group "},r.a.createElement("input",{type:"text",className:"form-control",value:s,onChange:function(e){return u(e.target.value)},placeholder:"Username",required:"required"})),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"password",onChange:function(e){return d(e.target.value)},value:p,className:"form-control",placeholder:"Password",required:"required"})),r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{type:"submit",className:"btn btn-primary btn-block"},"Log in")))))}a(63);function y(){var e=Object(n.useState)(""),t=Object(o.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)(""),s=Object(o.a)(l,2),u=s[0],m=s[1],f=Object(n.useState)(""),p=Object(o.a)(f,2),d=p[0],E=p[1],h=Object(n.useState)(""),N=Object(o.a)(h,2),y=N[0],j=N[1],O=Object(n.useState)(""),w=Object(o.a)(O,2),C=w[0],S=w[1],x=Object(n.useState)(""),k=Object(o.a)(x,2),U=k[0],q=k[1],F=function(){var e=Object(v.a)(g.a.mark((function e(t){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a&&u&&d&&y||S("Missing Fields"),d!==y&&S("Passwords do not match"),e.prev=3,e.next=6,i.a.post("/register",{name:a,username:u,password:d});case 6:n=e.sent,console.log(n.data),S(n.data.message),q(n.data.qr),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(3),S(e.t0.response.data);case 15:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"container mt-3"},C&&r.a.createElement(b,{message:C,onClick:function(){return S("")}}),U?r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Scan qr in google authenticator"),r.a.createElement("img",{src:U,style:{margin:"0 auto"},alt:"qrcode"})):r.a.createElement("div",{className:"register-container mt-5"},r.a.createElement("div",{className:"login-form"},r.a.createElement("form",{onSubmit:F},r.a.createElement("h2",{className:"text-center mb-4"},"Register"),r.a.createElement("div",{className:"form-group "},r.a.createElement("input",{type:"text",className:"form-control",placeholder:"Name",value:a,onChange:function(e){return c(e.target.value)},required:"required"})),r.a.createElement("div",{className:"form-group "},r.a.createElement("input",{type:"text",className:"form-control",placeholder:"Username",value:u,onChange:function(e){return m(e.target.value)},required:"required"})),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"password",className:"form-control",placeholder:"Password",value:d,onChange:function(e){return E(e.target.value)},required:"required"})),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"password",className:"form-control",placeholder:"Confirm password",value:y,onChange:function(e){return j(e.target.value)},required:"required"})),r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{type:"submit",className:"btn btn-primary btn-block"},"Sign Up"))))))}var j=a(2),O=function(e){var t=e.percentage;return r.a.createElement("div",{className:"progress"},r.a.createElement("div",{className:"progress-bar progress-bar-striped bg-success",role:"progressbar",style:{width:"".concat(t,"%")},"aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100"},t,"%"))},w=function(e){var t=e.currentUser,a=Object(n.useState)(""),c=Object(o.a)(a,2),l=c[0],s=c[1],u=Object(n.useState)("Choose File"),m=Object(o.a)(u,2),f=m[0],p=m[1],d=Object(n.useState)(0),E=Object(o.a)(d,2),h=E[0],N=E[1],y=Object(n.useState)(""),j=Object(o.a)(y,2),w=j[0],C=j[1],S=function(){var e=Object(v.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.target.files[0]||C("No File Added."),s(t.target.files[0]),p(t.target.files[0].name);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=Object(v.a)(g.a.mark((function e(a){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),(n=new FormData).append("file",l),e.prev=3,e.next=6,i.a.post("/upload",n,{headers:{"Content-Type":"multipart/form-data",Authorization:t},onUploadProgress:function(e){N(parseInt(Math.round(100*e.loaded/e.total)))}});case 6:setTimeout((function(){return N(0)}),1e4),C("File Uploaded!"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),500===e.t0.response.status?C("There was a problem with the server"):C(e.t0.response.data.msg);case 13:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(n.Fragment,null,w&&r.a.createElement(b,{message:w,onClick:function(){return C("")}}),r.a.createElement("form",{onSubmit:x},r.a.createElement("div",{className:"custom-file mt-4 mb-4"},r.a.createElement("input",{type:"file",className:"custom-file-input",id:"customFile",onChange:S}),r.a.createElement("label",{className:"custom-file-label",htmlFor:"customFile"},f)),r.a.createElement(O,{percentage:h}),r.a.createElement("input",{type:"submit",value:"upload",className:"btn btn-primary btn-block mt-4"})))};function C(e){var t=e.currentUser;return r.a.createElement("div",{className:"container mt-4"},r.a.createElement("h1",null,"Upload file"),r.a.createElement(w,{currentUser:t}))}a(64);var S=function(e){var t=e.currentUser,a=Object(n.useState)(""),c=Object(o.a)(a,2),l=c[0],s=c[1],u=Object(n.useState)(""),m=Object(o.a)(u,2),i=m[0],f=m[1],p=Object(n.useState)({}),d=Object(o.a)(p,2),E=d[0],h=d[1],g=Object(n.useState)(""),v=Object(o.a)(g,2),N=v[0],y=v[1],j=Object(n.useState)(""),O=Object(o.a)(j,2),w=O[0],C=O[1],S=Object(n.useState)(""),x=Object(o.a)(S,2),k=x[0],U=x[1];Object(n.useEffect)((function(){q()}),[]),Object(n.useEffect)((function(){E.name&&f(E.name),y(""),C("")}),[E]);var q=function(){fetch("/user",{headers:{Authorization:t}}).then((function(e){return e.json()})).then((function(e){h(e)})).catch((function(e){return alert(e)}))};return r.a.createElement("div",{style:{width:"90%",height:"100%",margin:"10px auto"}},l&&r.a.createElement(b,{message:l}),r.a.createElement("h1",{className:"m-4"},"User Information."),r.a.createElement("h2",{className:"ml-4"},"Hi ",E.username),r.a.createElement("div",{className:"mt-4",style:{width:"100%",height:"100%",display:"flex",margin:"0 auto"}},r.a.createElement("div",{className:"form-container"},r.a.createElement("form",{id:"nameDiv",onSubmit:function(e){e.preventDefault(),i?i!==E.name?fetch("/user/update/name",{method:"PUT",headers:{Authorization:t,"Content-Type":"application/json"},body:JSON.stringify({name:i})}).then((function(e){return e.json()})).then((function(e){q(),s("Name updated successfully")})).catch((function(e){return s("Could not change name.")})):s("New name is equal to current name"):s("Cannot set name to empty")}},r.a.createElement("p",null,"Name:"),r.a.createElement("div",{className:"form-group mx-sm-3 mb-2"},r.a.createElement("input",{className:"form-control",type:"text",name:"name",value:i,onChange:function(e){return f(e.target.value)}})),r.a.createElement("button",{type:"submit",className:"btn btn-primary mb-2"},"Update name")),r.a.createElement("form",{id:"passwordDiv",onSubmit:function(e){e.preventDefault(),N&&w?N!==w?fetch("/user/update/password",{method:"PUT",headers:{Authorization:t,"Content-Type":"application/json"},body:JSON.stringify({currentPassword:N,newPassword:w})}).then((function(e){if(200!==e.status)throw new Error("Password could not be changed");return e.json()})).then((function(e){q(),s("Password updated successfully")})).catch((function(e){console.log(e),s("Invalid current password. Unable to change password.")})):s("New password cannot be equal to current password"):s("Password Fields cannot be empty.")},className:"form-control"},r.a.createElement("h3",null,"Change Password:"),r.a.createElement("div",{className:"form-group mx-sm-3 mb-2"},r.a.createElement("label",null,"Current Password"),r.a.createElement("input",{className:"form-control",type:"password",value:N,onChange:function(e){return y(e.target.value)}})),r.a.createElement("div",{className:"form-group mx-sm-3 mb-2"},r.a.createElement("label",null,"Current Password"),r.a.createElement("input",{className:"form-control",type:"password",value:w,onChange:function(e){return C(e.target.value)}})),r.a.createElement("div",{className:"form-group mx-sm-3 mb-2"},r.a.createElement("button",{type:"submit",className:"btn btn-primary mb-2"},"Change Password")))),r.a.createElement("div",{className:"multifactor-codegen"},r.a.createElement("h3",null,"Multifactor QR code"),k?r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"Remember to scan this code or you will lose access to your account"),r.a.createElement("img",{src:k,style:{margin:"10px auto"},alt:"qrcode"})):r.a.createElement("button",{onClick:function(e){fetch("/user/update/multifactor",{method:"PUT",headers:{Authorization:t}}).then((function(e){if(200!==e.status)throw new Error("Could not update multifactor");return e.json()})).then((function(e){s(e.message),U(e.qr)})).catch((function(e){console.log(e),s("Can't generate multifactor qr at this time")})),U()},className:"btn btn-primary mb-2"},"Generate new multifactor qr code"))))},x=(a(65),function(e){var t=e.currentUser,a=Object(n.useState)([]),c=Object(o.a)(a,2),l=c[0],s=c[1];return Object(n.useEffect)((function(){fetch("/logs",{headers:{Authorization:t}}).then((function(e){return e.json()})).then((function(e){e.length>0&&s(e)})).catch((function(e){return alert(e)}))}),[t]),r.a.createElement("div",{style:{width:"90%",height:"100%",margin:"10px auto"}},r.a.createElement("h1",{className:"m-4"},"User Activity."),l&&r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Date"),r.a.createElement("th",null,"Time"),r.a.createElement("th",null,"Action"),r.a.createElement("th",null,"File (opt)"))),r.a.createElement("tbody",null,l.map((function(e){var t=new Date(e.date);return r.a.createElement("tr",{key:e._id},r.a.createElement("td",null,t.toLocaleDateString()),r.a.createElement("td",null,t.toLocaleTimeString()),r.a.createElement("td",null,e.action),r.a.createElement("td",null,e.file))})))))});var k=function(){var e=Object(n.useState)(!1),t=Object(o.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)(null),m=Object(o.a)(l,2),i=m[0],f=m[1];return Object(n.useEffect)((function(){var e=localStorage.getItem("user");e&&(c(!0),f(e))}),[]),r.a.createElement("div",{className:"App"},r.a.createElement(s.a,null,r.a.createElement(u,{currentUser:i,isLogged:a,setisLogged:c}),r.a.createElement(j.d,null,r.a.createElement(j.b,{exact:!0,path:"/"},a?r.a.createElement(E,{currentUser:i}):r.a.createElement(j.a,{to:"/login"})),r.a.createElement(j.b,{exact:!0,path:"/information"},a?r.a.createElement(S,{currentUser:i}):r.a.createElement(j.a,{to:"/"})),r.a.createElement(j.b,{exact:!0,path:"/login"},a?r.a.createElement(j.a,{to:"/"}):r.a.createElement(N,{setisLogged:c,setcurrentUser:f})),r.a.createElement(j.b,{path:"/register"},a?r.a.createElement(j.a,{to:"/"}):r.a.createElement(y,null)),r.a.createElement(j.b,{path:"/upload"},a?r.a.createElement(C,{currentUser:i}):r.a.createElement(j.a,{to:"/login"})),r.a.createElement(j.b,{path:"/activity"},a?r.a.createElement(x,{currentUser:i}):r.a.createElement(j.a,{to:"/login"})))))};l.a.render(r.a.createElement(k,null),document.getElementById("root"))}},[[30,1,2]]]);
//# sourceMappingURL=main.3fb25e37.chunk.js.map